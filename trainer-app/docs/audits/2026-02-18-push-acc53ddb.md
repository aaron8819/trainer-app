# Workout Audit ‚Äî acc53ddb (Push)

**Date:** 2026-02-18
**Mode:** Regression verification vs a34102df (prior session deleted from DB; temporal layers 7‚Äì10 skipped)
**Session:** Push | Hypertrophy | Accumulation Block, Week 1 of 4 | 5 exercises | ~30 working sets | 76 min estimated
**Purpose:** Verify 9 engine fixes (C1, W1‚ÄìW6, I2‚ÄìI4) implemented after audit of a34102df

---

## Regression Scorecard

| Fix | Status | Notes |
|-----|--------|-------|
| C1 ‚Äî Triceps isolation cap | ‚úÖ PASS | 2 pressing compounds (BBP + Dip), 1 isolation (Skull Crusher). `beam-search.ts:L177` fires correctly |
| W1 ‚Äî Lengthened triceps preference | ‚úÖ PASS | Skull Crusher 4/5 selected; all overhead options time-excluded (preference ordering untestable this session) |
| W2 ‚Äî No isolation pattern duplicate | ‚úÖ PASS | Extension + abduction = different patterns, different muscles |
| W3 ‚Äî Front raise suppression | ‚úÖ PASS | Front delt effective volume ~5.9 sets > 3.5 threshold; front raises time-excluded first but W3 would have fired too |
| W4 ‚Äî Differentiated rest periods | ‚úÖ PASS | `rest.seconds` correct. `formatRestDuration` helper: sub-120s shown as "90s", ‚â•120s rounded to min. Skull Crusher + Lateral Raise now show "90s" |
| W5 ‚Äî Compounds before isolations | ‚úÖ PASS | Order: Incline DB ‚Üí BBP ‚Üí Dip ‚Üí Skull Crusher ‚Üí Lateral Raise |
| W6 ‚Äî Triceps SRA = 48h | ‚úÖ PASS | `volume-landmarks.ts:L20` confirms 48h. No prior session to time-check |
| I2 ‚Äî "lbs" in narratives | ‚úÖ PASS | All 5 narratives show lbs (55lbs, 160lbs, 105.5lbs, 17.5lbs, 10lbs) |
| I3 ‚Äî muscleStatuses non-empty | ‚úÖ PASS | 10 fully-populated muscle entries in API response |
| I4 ‚Äî Set count text accurate | ‚úÖ PASS | "base 4, +25% for intermediate main lift" exact match; accessory percentages mathematically correct |

**Result: 10/10 resolved. All regression fixes verified.**

**Post-audit fixes applied (2026-02-18):** W4 rest narrative, blockContext label, triceps session ceiling (C1b).

---

## üî¥ CRITICAL Issues

None.

---

## üü° WARNINGS

### ~~W4 Residual ‚Äî Rest Period Narrative Shows "2 min" for 90s Isolations~~ ‚úÖ FIXED

- **Root cause**: `Math.round(90 / 60) = 2` in JavaScript (rounds 1.5 up).
- **Fix applied**: Added `formatRestDuration(seconds)` helper in `prescription-rationale.ts` ‚Äî returns `"${seconds}s"` when `< 120`, `"${Math.round(seconds/60)} min"` otherwise. Used in both `explainRestPeriod` reason strings and `overallNarrative`.
- **Result**: Skull Crusher and Lateral Raise now show `"90s for isolation‚Ä¶"` and `"‚Ä¶90s rest"`.

---

### Side Delts Below MEV (Time-Budget Constrained)

- **What**: Session adds only 4 direct side delt sets (Machine Lateral Raise √ó4) vs. engine MEV of 8. If this is the week's only push session, side delts end the week at 50% MEV.
- **KB¬ß**: "Side delts: MEV 6‚Äì8, MAV 16‚Äì22, MRV ~26 sets/week. The priority muscle for aesthetics (shoulder width). Tolerate very high frequency (3‚Äì6√ó/week)." ‚Äî KB ¬ß4 Shoulders.
- **Engine¬ß**: `volume-landmarks.ts:L14`: `"Side Delts": { mev: 8, sraHours: 36 }`. Engine correctly flags `status: "below_mev"` in volumeStatus. Cable Lateral Raise and Dumbbell Lateral Raise both excluded by `time_budget_exceeded`.
- **Note**: Side delts recover in ~36h and tolerate daily training. Supplemental lateral raises on a non-push day would address this at low recovery cost.

---

### ~~Triceps Per-Session Volume Exceeds KB Per-Session Guideline~~ ‚úÖ FIXED (C1b)

- **Root cause**: C1 capped isolations but not total direct sets. BBP (5) + Dip (5) + Skull Crusher (3) = 13 direct sets > 12 KB guideline.
- **Fix applied**: C1b guard in `beam-search.ts` immediately after C1. `SESSION_TRICEPS_CEILING = 12` ‚Äî if adding a candidate would push total `volumeContribution.get("Triceps")?.direct` past 12, the candidate is blocked.
- **Result**: With 2 pressing compounds (10 direct sets), the 3-set Skull Crusher is blocked. A 2-set variant (total = 12) would be allowed. Single compound (5 sets) + 3-set isolation = 8 ‚Äî unaffected.

---

## üîµ INFO / Optimizations

### Overhead Triceps Extension Excluded by Time Budget

The KB's highest-priority triceps exercise (Overhead Cable/Dumbbell Extension, Maeo et al. 2023: +40% growth vs pushdowns) was excluded by `time_budget_exceeded`. The Skull Crusher (4/5 lengthened) is a sound substitute but not equivalent. Trimming 1 set from a pressing compound would free ~3‚Äì4 min. No engine change needed.

### ~~blockContext Shows "Standard Progression" During Accumulation Week 1~~ ‚úÖ FIXED

- **Root cause**: `determineBlockPhase` inferred block type from `setMultiplier > 1.1 && rpeOffset < 0`. Week 0 periodization has `setMultiplier=1.0` ‚Äî fails the `> 1.1` check ‚Üí falls through to `"Standard progression"`.
- **Fix applied**: Added `blockType?: BlockType` to `PrescriptionRationaleContext`. `explainSetCount` accepts it as a 5th param and uses it directly, bypassing re-inference. `"realization"` maps to `"standard"`. API call site in `explainability.ts` passes `blockContext?.block.blockType`.
- **Result**: Accumulation Week 1 now correctly shows `"Accumulation (+15% volume)"` in all prescription rationales.

### I4 Minor ‚Äî "Intermediate" Label Mis-attributes Set Count Source

The percentage strings say "for intermediate main lift / accessory", implying extra sets come from training age. For intermediates, age multiplier = 1.0√ó; the extra sets actually come from the hypertrophy goal multiplier (1.25√ó) and periodization. Math is correct; attribution is slightly misleading.

### W3 Rejection Code Not Surfaced in filteredExercises

Front raise exercises show `time_budget_exceeded` in `filteredExercises`, not `volume_ceiling_reached`. The time-budget check runs before W3 in the beam loop, so W3's `volume_ceiling_reached` rejection is never written. Functionally correct; the UI says "Session time limit reached" rather than "Front delt volume already sufficient." Minor explainability gap.

---

## Volume & Calibration Table

| Muscle | Engine MEV | Engine MAV | Engine MRV | Engine SRA | KB MEV | KB MAV | KB MRV | Delta MEV | Delta MRV | Post-Session Sets | Status |
|--------|-----------|-----------|-----------|-----------|--------|--------|--------|-----------|-----------|-------------------|--------|
| Chest | 10 | 16 | 22 | 60h | 8‚Äì10 | 12‚Äì20 | ~22 | 0 | 0 | 15 | ‚úì Optimal |
| Front Delts | 0 | 7 | 12 | 48h | 0 | 6‚Äì8 | ~12 | 0 | 0 | ~5.9 | ‚úì |
| Side Delts | 8 | 19 | 26 | 36h | 8 | 16‚Äì22 | ~26 | 0 | 0 | 4 | ‚ö†Ô∏è Below MEV |
| Triceps | 6 | 12 | 18 | 48h | 4‚Äì6 | 10‚Äì14 | ~18 | 0 | 0 | ~14.5 ‚Üí capped ‚â§12 (C1b) | ‚úÖ Capped |

No calibration delta exceeds ¬±2 sets. All engine constants align with KB values.

---

## Exercise Details

| Exercise | Type | Sets | Reps | Load | RIR | Rest (seconds) | Rest (narrative) | Lengthened |
|----------|------|------|------|------|-----|----------------|-----------------|-----------|
| Incline Dumbbell Bench Press | Main lift | 5 | 6 | 55 lbs | 3 | 150 | "3 min" ‚úì | 4/5 |
| Barbell Bench Press | Main lift | 5 | 6 | 160 lbs | 3 | 180 | "3 min" ‚úì | 3/5 |
| Dip (Chest Emphasis) | Compound accessory | 5 | 10 | 105.5 lbs | 3 | 120 | "2 min" ‚úì | 4/5 |
| Lying Triceps Extension (Skull Crusher) | Isolation | 3 | 10 | 17.5 lbs | 2.5 | 90 | "90s" ‚úì (fixed) | 4/5 |
| Machine Lateral Raise | Isolation | 4 | 10 | 10 lbs | 2.5 | 90 | "90s" ‚úì (fixed) | 2/5 |

---

## Recommended Actions (Priority Order)

1. ~~**[W4 bug]** Fix rest narrative rounding~~ ‚úÖ Done ‚Äî `formatRestDuration` helper in `prescription-rationale.ts`.

2. ~~**[INFO]** Fix `blockContext` in prescription rationale~~ ‚úÖ Done ‚Äî `blockType?` field threaded from `BlockContext` through `explainPrescriptionRationale` ‚Üí `explainSetCount`.

3. ~~**[WARNING]** Add per-session triceps volume cap to beam search~~ ‚úÖ Done ‚Äî C1b guard (`SESSION_TRICEPS_CEILING = 12`) in `beam-search.ts`.

4. **[WARNING]** Surface side delt MEV deficit in coach messages ‚Äî when a primary push muscle will end the week below MEV due to time constraints, suggest supplemental work (e.g., "add 2 sets of lateral raises on a rest day"). **Open.**
